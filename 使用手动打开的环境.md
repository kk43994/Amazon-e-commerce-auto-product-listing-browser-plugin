# 使用手动打开的紫鸟环境

**问题**: WebDriver模式不会加载GUI中配置的环境

**解决方案**: 手动打开GUI环境,然后代码连接控制

---

## 步骤1: 手动打开紫鸟GUI环境

1. **双击运行**: `D:\ziniao\ziniao.exe` (不要用命令行启动)
2. **登录账号**: 使用你的 banbantt 账号
3. **选择环境**: 找到 "小昭 日本0-1" 环境
4. **点击打开**: 环境会自动打开并登录到亚马逊后台
5. **保持窗口打开**: 不要关闭浏览器窗口

---

## 步骤2: 找到浏览器调试端口

打开的浏览器窗口会监听一个调试端口,但紫鸟GUI不会直接显示端口号。

**方法1: 使用紫鸟API查询** (推荐)

虽然GUI模式在运行,但HTTP API仍然可用。运行:

```bash
python find_running_browser.py
```

这个脚本会:
- 连接到紫鸟HTTP API
- 调用 getRunningInfo 获取正在运行的浏览器列表
- 显示每个浏览器的调试端口

**方法2: 手动查找**

1. 打开任务管理器
2. 找到 Chrome 进程
3. 查看命令行参数中的 `--remote-debugging-port=XXXXX`

---

## 步骤3: 使用代码连接

找到端口后(比如 12345),运行:

```python
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
import time

# 连接到已打开的浏览器
debug_port = 12345  # 替换为实际端口

options = Options()
options.add_experimental_option("debuggerAddress", f"127.0.0.1:{debug_port}")

driver = webdriver.Chrome(
    service=Service("drivers/chromedriver137.exe"),
    options=options
)

print(f"已连接!")
print(f"当前URL: {driver.current_url}")
print(f"页面标题: {driver.title}")

# 现在可以进行自动化操作
# driver.find_element(...)
```

---

## 完整的自动化流程

```
1. 手动: 打开紫鸟GUI → 选择环境 → 打开
2. 自动: 查询调试端口 (getRunningInfo API)
3. 自动: Selenium连接到该端口
4. 自动: 读取Excel商品数据
5. 自动: 导航到添加商品页面
6. 自动: 填写商品信息
7. 自动: 提交上传
8. 自动: 循环处理下一个商品
```

---

## 但是...还有更好的方法!

实际上,紫鸟的 `startBrowser` API **应该会加载你配置的环境**!

让我检查API文档,看是否有参数可以指定使用已配置的环境...
