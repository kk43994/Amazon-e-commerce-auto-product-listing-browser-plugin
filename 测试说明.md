# 紫鸟浏览器连接测试说明

## 📋 测试目的

验证能否成功连接和控制紫鸟浏览器，为后续开发RPA自动化功能做准备。

---

## 🔧 测试前准备

### 1. 安装Python环境

确保已安装 Python 3.8 或更高版本：

```bash
python --version
```

如果未安装，请访问: https://www.python.org/downloads/

### 2. 安装依赖包

在项目目录下运行：

```bash
pip install -r requirements.txt
```

或者单独安装：

```bash
pip install selenium requests
```

### 3. 获取紫鸟浏览器

- 确保已安装紫鸟浏览器
- **版本要求**: Windows V6.16.0.126+ 或 Mac V6.15.0.44+
- 下载地址: https://www.superbrowser.com/download

### 4. 申请WebDriver权限

⚠️ **重要**: 首次使用需要申请权限

1. 访问: https://open.superbrowser.com/
2. 登录你的紫鸟账号
3. 申请开通 WebDriver 权限
4. 添加生态管家微信，备注"紫鸟webdriver"

### 5. 关闭紫鸟浏览器主进程

测试前必须关闭已运行的紫鸟浏览器，否则无法启动WebDriver模式。

---

## ⚙️ 配置测试脚本

打开 `test_ziniao_connection.py` 文件，修改以下配置：

### 1. 紫鸟浏览器路径

**Windows 示例:**
```python
ZINIAO_CLIENT_PATH = r"C:\Program Files\ZiNiao\SuperBrowser.exe"
```

**Mac 示例:**
```python
ZINIAO_CLIENT_PATH = "/Applications/SuperBrowser.app/Contents/MacOS/SuperBrowser"
```

💡 **如何找到安装路径？**
- Windows: 右键桌面快捷方式 → 属性 → 目标
- Mac: 打开访达 → 应用程序 → 右键SuperBrowser → 显示包内容

### 2. 紫鸟账号信息

```python
ZINIAO_COMPANY = "你的公司名"      # 登录时使用的公司名
ZINIAO_USERNAME = "你的用户名"     # 你的紫鸟账号
ZINIAO_PASSWORD = "你的密码"       # 你的密码
```

### 3. 通信端口（可选）

```python
ZINIAO_PORT = 8848  # 默认即可，如有冲突可修改
```

---

## 🚀 运行测试

在命令行中运行：

```bash
python test_ziniao_connection.py
```

或者在Windows中双击运行 `test_ziniao_connection.py` 文件。

---

## 📊 测试步骤说明

测试脚本会依次执行以下步骤：

### ✅ 步骤1: 启动紫鸟浏览器
- 以WebDriver模式启动紫鸟浏览器主进程
- 监听指定的HTTP端口

### ✅ 步骤2: 测试HTTP连接
- 尝试连接到紫鸟浏览器的HTTP接口
- 验证通信通道是否正常

### ✅ 步骤3: 登录紫鸟账号
- 使用配置的账号信息登录
- 验证账号权限

### ✅ 步骤4: 获取店铺列表
- 从账号中获取所有店铺（浏览器环境）
- 显示店铺名称、平台等信息

### ✅ 步骤5: 启动店铺浏览器
- 启动第一个店铺的浏览器窗口
- 获取调试端口（用于Selenium连接）

---

## ✅ 预期结果

如果一切正常，你会看到：

```
============================================================
     紫鸟浏览器连接测试脚本
============================================================

⚠️  测试前请确保:
  1. 紫鸟浏览器主进程已关闭
  2. 已配置正确的安装路径和账号信息
  3. 已申请开通WebDriver权限

按 Enter 键开始测试...

============================================================

步骤 1/5: 启动紫鸟浏览器

============================================================

ℹ️  操作系统: Windows
ℹ️  客户端路径: C:\Program Files\ZiNiao\SuperBrowser.exe
ℹ️  通信端口: 8848
ℹ️  执行命令: ...
ℹ️  等待5秒让浏览器启动...
✅ 紫鸟浏览器启动命令已执行

============================================================

步骤 2/5: 测试HTTP连接

============================================================

ℹ️  目标地址: http://127.0.0.1:8848
ℹ️  尝试连接 (1/5)...
✅ HTTP连接成功！

... (后续步骤)

============================================================

📊 测试总结

============================================================

✅ 基础连接测试通过
✅ 账号登录测试通过
✅ 成功获取 5 个店铺
✅ 店铺浏览器启动成功

✅ 恭喜！紫鸟浏览器连接测试全部通过！
接下来可以开始开发RPA自动化功能了。
```

---

## ❌ 常见问题排查

### 问题1: 无法启动紫鸟浏览器

**错误信息:**
```
❌ 未找到紫鸟浏览器: C:\Program Files\ZiNiao\SuperBrowser.exe
```

**解决方法:**
- 检查 `ZINIAO_CLIENT_PATH` 配置是否正确
- 确认紫鸟浏览器已安装
- 在文件管理器中找到实际安装路径

---

### 问题2: 无法建立HTTP连接

**错误信息:**
```
❌ 无法连接到紫鸟浏览器
```

**可能原因:**
1. 浏览器未启动成功
2. 端口被占用
3. 防火墙阻止连接
4. 紫鸟版本过低

**解决方法:**
- 检查任务管理器中是否有 SuperBrowser.exe 进程
- 尝试更换端口号（如8849、8850等）
- 关闭防火墙或添加例外
- 升级到最新版本紫鸟浏览器

---

### 问题3: 登录失败

**错误信息:**
```
❌ 登录失败: 账号或密码错误
```

**解决方法:**
- 确认公司名、用户名、密码是否正确
- 确认账号是否已开通WebDriver权限
- 联系紫鸟客服确认账号状态

---

### 问题4: 没有店铺

**提示信息:**
```
⚠️  账号下没有店铺
```

**解决方法:**
- 在紫鸟浏览器客户端中创建店铺
- 确认使用的是正确的账号

---

### 问题5: 版本不兼容

**可能表现:**
- 浏览器启动后立即关闭
- 无法识别 `--run_type=web_driver` 参数

**解决方法:**
- 升级紫鸟浏览器到最新版本
- 确保版本 >= Windows V6.16.0.126 或 Mac V6.15.0.44

---

## 📝 测试成功后的下一步

测试通过后，说明技术方案可行，可以开始开发：

1. ✅ **创建项目结构** - 建立完整的代码目录
2. ✅ **开发数据读取** - Excel表格解析模块
3. ✅ **开发自动化核心** - 亚马逊页面操作
4. ✅ **实现批量处理** - 队列管理和错误处理
5. ✅ **开发用户界面** - GUI或Web界面

---

## 🆘 获取帮助

如果遇到无法解决的问题：

1. **查看日志** - 脚本会输出详细的错误信息
2. **截图保存** - 记录错误现场
3. **联系紫鸟支持** - 微信添加生态管家
4. **查阅文档** - https://open.superbrowser.com/docSupport

---

## 📞 紫鸟技术支持

- **微信**: 扫描二维码添加生态管家（在紫鸟开放平台可找到）
- **备注**: "紫鸟webdriver"
- **官网**: https://www.superbrowser.com/
- **文档**: https://open.superbrowser.com/docSupport

---

**文档版本**: v1.0
**创建日期**: 2025-11-12
**适用版本**: 紫鸟浏览器 Windows V6.16.0.126+ / Mac V6.15.0.44+
