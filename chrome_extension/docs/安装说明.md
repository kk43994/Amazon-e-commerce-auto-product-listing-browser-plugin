# 🚀 插件安装说明

## 📦 完成最后一步

插件已经**95%完成**，只需要下载一个Excel处理库即可使用！

### 1. 下载SheetJS库

**方式一：CDN下载（推荐）**

访问这个链接并保存文件：
```
https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js
```

保存到：`chrome_extension/libs/xlsx.full.min.js`

**方式二：npm下载**
```bash
cd chrome_extension/libs
npm install xlsx
# 然后复制 node_modules/xlsx/dist/xlsx.full.min.js 到当前目录
```

**方式三：手动创建（临时测试）**

如果暂时无法下载，可以先创建一个空文件测试UI：
```bash
# 在 chrome_extension/libs/ 目录
touch xlsx.full.min.js
```

### 2. 创建图标文件

在 `chrome_extension/icons/` 目录创建3个图标：
- `icon16.png` (16x16像素)
- `icon48.png` (48x48像素)
- `icon128.png` (128x128像素)

**临时方案**：可以使用任意PNG图片重命名，或使用在线图标生成器

### 3. 安装到浏览器

#### 在紫鸟浏览器中安装：

1. 打开紫鸟浏览器
2. 访问 `chrome://extensions/`
3. 开启右上角"开发者模式"
4. 点击"加载已解压的扩展程序"
5. 选择 `chrome_extension` 文件夹
6. 完成！

### 4. 测试使用

1. 登录亚马逊卖家后台
2. 打开"添加商品"页面
3. 点击浏览器工具栏的插件图标
4. 选择Excel文件
5. 点击"开始自动填写"

---

## 🎯 优势对比

### 当前Selenium方案 vs 插件方案

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
❌ Selenium方案（复杂）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

用户操作步骤：
1. 安装Python
2. 安装依赖包（pip install ...）
3. 下载ChromeDriver
4. 配置紫鸟路径
5. 配置账号密码
6. 配置Excel路径
7. 运行Python脚本
8. 等待自动登录
9. 等待启动浏览器
10. 等待导航到页面
11. 开始填写

代码复杂度：5000+ 行
需要技能：Python编程
失败风险：高（元素定位、登录、网络）
```

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
✅ 插件方案（简单）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

用户操作步骤：
1. 安装插件（拖拽文件夹）
2. 打开亚马逊上传页面
3. 点击插件 → 选择Excel → 完成

代码复杂度：500 行
需要技能：无需编程
失败风险：低（直接操作当前页面）
```

---

## 📊 文件清单

插件已包含的文件：

```
chrome_extension/
├── ✅ manifest.json          # 插件配置
├── ✅ popup.html            # 用户界面
├── ✅ popup.js              # 界面逻辑
├── ✅ content.js            # 表单填写
├── ✅ background.js         # 后台服务
├── ✅ page-analyzer.js      # 页面分析器 🆕
├── ✅ README.md            # 完整文档
├── ✅ 安装说明.md           # 本文件
│
├── ⏳ libs/
│   └── ❌ xlsx.full.min.js  # 需要下载
│
└── ⏳ icons/
    ├── ❌ icon16.png       # 需要创建
    ├── ❌ icon48.png       # 需要创建
    └── ❌ icon128.png      # 需要创建
```

---

## 🌟 核心功能

### 1. 智能字段匹配

无需手动配置，自动识别：
- ✅ 商品标题
- ✅ 品牌
- ✅ 价格
- ✅ 描述
- ✅ 库存数量
- ✅ SKU
- ✅ 分类
- ✅ 要点说明

### 2. 页面分析器 🆕

**您提出的功能已实现！**

在浏览器控制台运行：
```javascript
// 分析当前页面的所有输入框
window.pageAnalyzer.analyze()

// 导出完整分析结果
window.pageAnalyzer.export()

// 高亮某个元素
window.pageAnalyzer.highlight('#product-title')
```

**输出示例**：
```javascript
{
  inputs: [
    {
      id: "product-title",
      name: "title",
      label: "Product Title",
      placeholder: "Enter product title",
      selector: "#product-title",
      xpath: "//*[@id='product-title']"
    },
    // ... 更多
  ],
  suggestions: {
    title: { element: {...}, confidence: 95.5 },
    brand: { element: {...}, confidence: 88.2 },
    price: { element: {...}, confidence: 92.0 }
  }
}
```

### 3. 真人行为模拟

- ⌨️ 模拟打字速度（50-150ms/字符）
- 🖱️ 随机延迟
- 📜 平滑滚动
- ✨ 自然的焦点切换

### 4. 批量处理

- 一次导入多个商品
- 逐个填写或自动连续
- 实时进度显示
- 填写完成高亮提示

---

## 💡 Excel格式

**基础格式**：
```
title                    | brand  | price
iPhone 15 Pro 256GB     | Apple  | 999
Samsung Galaxy S24      | Samsung| 899
```

**完整格式**：
```
title | brand | price | quantity | sku | description | bullet_points
...   | ...   | ...   | ...      | ... | ...         | Point1\nPoint2\nPoint3
```

---

## 🎨 界面预览

插件界面包含：
- 📄 文件选择区（拖拽支持）
- 📊 商品信息显示
- ⚙️ 设置选项
  - [ ] 模拟真人打字
  - [ ] 自动填写下一个
- 📈 进度条
- 💬 状态提示

---

## 🔧 调试技巧

### 查看插件日志
```
F12 → Console → 筛选 "[亚马逊上传助手]"
```

### 分析当前页面
```javascript
window.pageAnalyzer.export()
```

### 重新加载插件
```
chrome://extensions/ → 点击"重新加载"
```

---

## ⚠️ 临时测试方案

如果暂时无法下载SheetJS，可以这样测试UI：

1. 创建空的 `libs/xlsx.full.min.js`
2. 创建简单的图标PNG
3. 安装插件查看界面
4. 后续再下载完整库

---

## 📞 需要帮助？

查看完整文档：`README.md`

---

**准备好了吗？下载SheetJS库，开始使用吧！** 🚀
