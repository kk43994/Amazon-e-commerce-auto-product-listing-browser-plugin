# Chrome扩展插件测试指南

> 测试日期: 2025-11-21
> 版本: 2.0.0

---

## 📋 测试准备

### 前置条件检查

- [ ] Chrome浏览器已安装（建议最新版）
- [ ] 已准备Amazon Seller Central账号
- [ ] 网络连接正常
- [ ] 已准备测试商品数据

---

## 🔧 第一步：加载插件

### 1.1 打开Chrome扩展管理页面

```
方法1: 地址栏输入
chrome://extensions/

方法2: 菜单点击
Chrome菜单 → 更多工具 → 扩展程序
```

### 1.2 启用开发者模式

- 右上角找到"开发者模式"开关
- 点击开启（变成蓝色）

### 1.3 加载插件

**如果已安装（更新）：**
```
找到"亚马逊商品快速上传助手"
→ 点击 🔄 "重新加载" 按钮
```

**如果未安装（首次）：**
```
点击"加载已解压的扩展程序"
→ 选择文件夹: C:\Users\zhouk\Desktop\ziniao\chrome_extension
→ 点击"选择文件夹"
```

### 1.4 验证加载成功

✅ 检查项：
- [ ] 插件卡片显示"亚马逊商品快速上传助手"
- [ ] 状态显示为"已启用"（不是灰色）
- [ ] 没有红色错误提示
- [ ] 浏览器工具栏出现紫色图标

❌ 如果出现错误：
```
1. 查看错误信息
2. 检查文件完整性
3. 确认manifest.json无语法错误
4. 刷新页面重试
```

---

## 🌐 第二步：打开Amazon页面

### 2.1 访问Amazon Seller Central

```
URL: https://sellercentral-japan.amazon.com
```

### 2.2 登录账号

- 输入卖家账号和密码
- 完成两步验证（如果需要）
- 确保成功登录到主页

### 2.3 打开浏览器控制台（重要）

```
方法1: 快捷键
Windows: F12 或 Ctrl+Shift+I
Mac: Cmd+Option+I

方法2: 右键菜单
右键页面 → 检查
```

### 2.4 检查Content Script加载

在控制台（Console标签）应该看到：

```
[亚马逊上传助手] Content script加载完成
[初始化] 开始...
✓ PageDetector已加载
✓ AmazonNavigator已加载
✓ AmazonFormFiller已加载
[初始化] 完成
[亚马逊上传助手] 准备就绪！
- PageDetector: ✓
- AmazonNavigator: ✓
- FormFiller: ✓
```

✅ **如果看到上述日志 = 插件加载成功！**

❌ **如果看到警告或错误：**
```javascript
// 示例错误
⚠️ PageDetector未加载

// 解决方法：
1. 刷新页面（F5）
2. 重新加载插件
3. 检查manifest.json中的js文件顺序
```

---

## 🎛️ 第三步：测试基础功能

### 3.1 测试插件图标点击

**操作：**
- 点击浏览器工具栏的插件图标（紫色圆形）

**预期结果：**
- [ ] 弹出窗口显示（420px宽）
- [ ] 标题显示"🚀 亚马逊快速上传助手"
- [ ] 副标题显示"从Excel一键批量上传商品到Amazon"
- [ ] 页面监控区域显示"当前页: 卖家中心首页"或其他
- [ ] 状态指示灯在闪烁（灰色或绿色）

**截图对比：**
```
应该看到这样的界面：

┌──────────────────────────────────────┐
│ 🚀 亚马逊快速上传助手               │
│ 从Excel一键批量上传商品到Amazon      │
├──────────────────────────────────────┤
│ ⚪ 当前页: 卖家中心首页      ✓ 页面正确 │
├──────────────────────────────────────┤
│ 📄 Excel数据文件                    │
│ ┌────────────────────────────────┐ │
│ │      📊                         │ │
│ │  点击选择Excel文件              │ │
│ └────────────────────────────────┘ │
│                                      │
│ ⚙️ 自动化设置                       │
│ ☑️ 自动搜索ASIN并进入表单           │
│ ☑️ 自动切换表单页面 (4个tab)       │
│ ☑️ 自动填写所有字段                 │
│ ☑️ 模拟真人行为 (随机延迟)         │
│                                      │
│ ▶️ 开始操作                         │
│ ┌────────────────────────────────┐ │
│ │ 🚀 开始全自动上传 (灰色/禁用)   │ │
│ └────────────────────────────────┘ │
│ ┌────────────────────────────────┐ │
│ │ ✍️ 仅填写当前页面 (灰色/禁用)   │ │
│ └────────────────────────────────┘ │
└──────────────────────────────────────┘
```

### 3.2 测试页面监控

**操作步骤：**

1. **保持在首页**
   - 观察页面监控区域
   - 状态点应该是灰色或绿色
   - 显示"当前页: 卖家中心首页"

2. **点击"添加商品"**
   - 导航到添加商品页面
   - 等待2-3秒

**预期结果：**
- [ ] 状态点变化（可能经历：灰色 → 橙色 → 绿色）
- [ ] 页面文本更新为"当前页: 添加商品页"
- [ ] 控制台显示：`[页面变化] home → addProduct`

**测试通过标准：**
✅ 页面监控能实时检测页面变化
✅ 状态指示灯颜色正确
✅ 页面名称显示准确

---

## 📄 第四步：测试Excel上传

### 4.1 准备测试数据

**方法A: 使用模板文件**
```
文件位置: chrome_extension/product_template_new.csv
可直接使用（已包含示例数据）
```

**方法B: 创建简单测试数据**

创建文件 `test_products.csv`:
```csv
asin,title,brand,your_price,quantity
B0D9XYDYBJ,测试商品A,测试品牌,1980,100
B0ABCDEFGH,测试商品B,测试品牌,2980,50
```

### 4.2 上传Excel文件

**操作：**
1. 点击"点击选择Excel文件"区域
2. 选择准备好的Excel/CSV文件
3. 点击"打开"

**预期结果：**
- [ ] 上传区域变绿色
- [ ] 显示文件名（例如：test_products.csv）
- [ ] 商品导航区域显示出来
- [ ] 显示"商品数量: 2"
- [ ] 显示当前商品信息
  - 当前商品: 测试商品A
  - ASIN: B0D9XYDYBJ
  - 价格: ¥1980
- [ ] "开始全自动上传"按钮变为可点击（不再灰色）
- [ ] "仅填写当前页面"按钮变为可点击
- [ ] 日志显示：`[INFO] 成功读取 2 个商品`

**控制台检查：**
```javascript
// 应该看到类似日志
[INFO] 正在读取Excel文件...
[SUCCESS] 成功读取 2 个商品
```

### 4.3 测试商品导航

**操作：**
1. 点击"下一个 ➡️"按钮
2. 观察商品信息变化
3. 点击"⬅️ 上一个"按钮

**预期结果：**
- [ ] 商品信息正确切换
- [ ] 第一个商品时"上一个"按钮禁用
- [ ] 最后一个商品时"下一个"按钮禁用
- [ ] 当前索引正确显示

---

## 🚀 第五步：测试ASIN搜索（核心功能）

### 5.1 返回首页

**操作：**
- 点击浏览器后退按钮
- 或点击Amazon Logo返回首页

### 5.2 准备测试ASIN

**使用真实ASIN（推荐）：**
```
B0D9XYDYBJ  (日本站真实商品)
```

或在Amazon Japan搜索任意商品，复制其ASIN。

### 5.3 开始测试

**操作步骤：**

1. 打开插件弹窗
2. 确保已上传Excel（包含ASIN）
3. 确认设置：
   - ☑️ 自动搜索ASIN并进入表单 **（必须勾选）**
   - ☑️ 自动切换表单页面
   - ☑️ 自动填写所有字段
   - ☑️ 模拟真人行为
4. 点击 **"🚀 开始全自动上传"**

**预期执行流程：**

```
阶段1: ASIN搜索 (约10-15秒)
├─ ✓ 自动点击"添加商品"
├─ ✓ 自动切换到"搜索"标签
├─ ✓ 自动输入ASIN
├─ ✓ 自动点击搜索按钮
├─ ✓ 等待搜索结果
├─ ✓ 自动点击第一个结果
├─ ✓ 自动点击"复制商品信息"
└─ ✓ 等待新tab打开
```

**控制台日志示例：**
```
========== 开始ASIN搜索流程 ==========
ASIN: B0D9XYDYBJ

[步骤1] 导航到添加商品页
✓ 已点击"添加商品"按钮
✓ 添加商品页面已加载

[步骤2] 切换到搜索标签
✓ 已切换到搜索标签

[步骤3] 搜索ASIN: B0D9XYDYBJ
✓ 已输入ASIN: B0D9XYDYBJ
✓ 已点击搜索按钮
✓ 搜索结果已加载

[步骤4] 点击搜索结果
✓ 已点击搜索结果

[步骤5] 点击复制商品信息
✓ 已点击"复制商品信息"

[步骤6] 切换到表单tab
✓ 等待表单页面打开...

✅ ASIN搜索流程完成
```

**检查要点：**

- [ ] **页面自动跳转** - 从首页 → 添加商品页
- [ ] **标签自动切换** - 从"我要销售的商品"→"搜索"
- [ ] **ASIN自动输入** - 看到输入框被填写
- [ ] **自动点击搜索** - 看到搜索结果列表
- [ ] **自动选择结果** - 第一个结果被点击
- [ ] **新tab打开** - 表单页面在新tab显示
- [ ] **页面监控更新** - 状态显示"产品详情"

### 5.4 可能出现的问题

**问题1: 未找到"添加商品"按钮**
```
原因: 页面结构可能不同
解决:
1. 手动点击"添加商品"
2. 取消"自动搜索ASIN"选项
3. 手动导航后使用"仅填写当前页面"
```

**问题2: 搜索无结果**
```
原因: ASIN不存在或网络问题
解决:
1. 检查ASIN拼写
2. 确认ASIN在Amazon Japan站点存在
3. 检查网络连接
```

**问题3: 新tab未自动切换**
```
原因: 浏览器阻止tab切换
解决:
1. 手动切换到新打开的tab
2. 继续测试表单填写功能
```

---

## ✍️ 第六步：测试表单填写

### 6.1 验证页面检测

**当前应该在：产品详情页**

检查popup状态：
- [ ] 页面监控显示"当前页: 产品详情"
- [ ] 状态指示灯为绿色
- [ ] URL包含 `/product_details`

### 6.2 测试手动填写（推荐先测试）

**操作：**
1. 打开插件弹窗
2. 点击 **"✍️ 仅填写当前页面"**

**预期结果：**

```
日志显示：
[INFO] 填写当前页面: 测试商品A
[INFO] 当前页面: productDetails
[INFO] 正在填写产品详情...
[SUCCESS] ✅ 填写完成
```

**检查表单：**

在Amazon页面上检查以下字段是否被填写：

- [ ] **商品名称** - 应该显示Excel中的title
- [ ] **品牌名** - 应该显示Excel中的brand
- [ ] **外部产品ID** - 如果有
- [ ] **制造商** - 如果有
- [ ] **产品描述** - 如果有
- [ ] **要点1-5** - 如果有
- [ ] **搜索关键字** - 如果有

**重要提示：**
```
✅ 如果字段被填写 = FormFiller工作正常
⚠️ 如果字段未填写 = 元素定位需要调整
```

### 6.3 检查字段高亮效果

**填写时应该看到：**
- 输入框边框变绿色（2px solid #4caf50）
- 背景变浅绿色（#e8f5e9）
- 1.5秒后恢复原样

### 6.4 测试其他页面

**操作步骤：**

1. **切换到"安全与合规"tab**
   - 手动点击页面上的tab
   - 或等待自动切换（如果勾选了自动导航）

2. **再次点击"仅填写当前页面"**

3. **重复测试"报价"和"图片"页面**

**检查每个页面：**

**安全与合规页：**
- [ ] 原产国下拉框被选择
- [ ] 保修说明被填写
- [ ] 危险商品规管被选择

**报价页：**
- [ ] 数量被填写
- [ ] 处理时间被填写
- [ ] 您的价格被填写
- [ ] 价格表被填写
- [ ] 配送渠道单选框被选中

**图片页：**
- [ ] 主图片上传（如果提供了路径）
- [ ] 附加图片上传（如果提供了路径）

---

## 🎯 第七步：测试全自动流程

### 7.1 重置测试环境

**操作：**
1. 关闭所有Amazon相关tab
2. 重新打开 `https://sellercentral-japan.amazon.com`
3. 重新上传Excel文件

### 7.2 开始全自动测试

**⚠️ 重要提醒：首次建议只测试1个商品**

**修改Excel数据：**
```csv
asin,title,brand,your_price,quantity
B0D9XYDYBJ,测试商品A,测试品牌,1980,100
```
只保留1行数据。

**操作步骤：**

1. 打开插件
2. 上传Excel（1个商品）
3. 确认所有自动化选项已勾选
4. 点击 **"🚀 开始全自动上传"**

**预期完整流程：**

```
========== 开始自动上传 ==========
总共 1 个商品

[1/1] 测试商品A
  [1/5] 搜索ASIN: B0D9XYDYBJ
  ✓ ASIN搜索完成

  [2/5] 填写产品详情
  ✓ 产品详情完成

  [3/5] 填写安全合规
  ✓ 安全合规完成

  [4/5] 填写报价
  ✓ 报价完成

  [5/5] 上传图片
  ✓ 图片完成

✅ 商品 1 上传完成

========== 全部完成 ==========
```

**观察要点：**

- [ ] 页面自动跳转（首页 → 添加商品 → 表单）
- [ ] tab自动切换（产品详情 → 安全合规 → 报价 → 图片）
- [ ] 字段逐个填写
- [ ] 每步之间有延迟（3-6秒）
- [ ] 进度条更新（0% → 100%）
- [ ] 日志实时显示
- [ ] 完成后显示成功消息

### 7.3 测试暂停/停止

**测试暂停：**
1. 开始自动上传
2. 在执行过程中点击"⏸️ 暂停"
3. 观察：操作停止，日志显示"⏸️ 已暂停"
4. 点击"▶️ 继续"
5. 观察：操作恢复

**测试停止：**
1. 开始自动上传
2. 点击"⏹️ 停止"
3. 观察：操作完全停止，日志显示"⏹️ 已停止"
4. 控制按钮隐藏

---

## 📊 第八步：功能完整性测试

### 8.1 状态恢复测试

**操作：**
1. 上传Excel文件（多个商品）
2. 切换到第2个商品
3. **关闭popup窗口**
4. **重新打开popup**

**预期结果：**
- [ ] 商品数据仍然存在
- [ ] 当前索引保持在第2个
- [ ] 日志显示"已恢复 X 个商品，当前第 Y 个"

### 8.2 设置保存测试

**操作：**
1. 取消某个自动化选项（例如：自动导航）
2. 关闭popup
3. 重新打开popup

**预期结果：**
- [ ] 设置被记住
- [ ] 对应选项仍然未勾选

### 8.3 错误处理测试

**测试1: 无效ASIN**
```
操作: 使用不存在的ASIN（如：INVALIDASIN）
预期: 显示错误消息，询问是否继续
```

**测试2: 网络中断**
```
操作: 断开网络连接后点击开始
预期: 显示网络错误，操作停止
```

**测试3: 空Excel**
```
操作: 上传空白Excel文件
预期: 显示"Excel文件为空"错误
```

---

## ✅ 测试检查清单

### 基础功能 (必测)

- [ ] ✅ 插件正确加载
- [ ] ✅ 控制台无错误
- [ ] ✅ 页面监控工作正常
- [ ] ✅ Excel上传成功
- [ ] ✅ 商品信息显示正确
- [ ] ✅ 商品导航正常

### 核心功能 (必测)

- [ ] ✅ ASIN搜索功能
- [ ] ✅ 自动页面导航
- [ ] ✅ 表单填写功能
- [ ] ✅ 日志正常显示
- [ ] ✅ 进度条更新

### 高级功能 (建议测试)

- [ ] ⭐ 批量处理（2个以上商品）
- [ ] ⭐ 暂停/停止控制
- [ ] ⭐ 状态恢复
- [ ] ⭐ 设置保存
- [ ] ⭐ 错误处理

### UI/UX (可选)

- [ ] 🎨 界面美观
- [ ] 🎨 响应及时
- [ ] 🎨 日志清晰
- [ ] 🎨 提示友好

---

## 🐛 常见问题排查

### 问题1: 插件图标灰色无法点击

**原因：** 不在Amazon页面
**解决：**
```
1. 确保URL包含 amazon.com 或 amazon.co.jp
2. 刷新页面
3. 检查manifest.json的host_permissions
```

### 问题2: 控制台显示"未加载"

**症状：**
```
⚠️ PageDetector未加载
⚠️ AmazonNavigator未加载
```

**解决：**
```
1. 检查文件是否存在
2. 检查文件名拼写
3. 重新加载插件
4. 清除浏览器缓存
```

### 问题3: 页面监控显示"未知"

**原因：** 页面检测逻辑需要调整
**解决：**
```
1. 检查URL是否正确
2. 查看page-detector.js的detectCurrentPage方法
3. 添加更多检测策略
```

### 问题4: ASIN搜索失败

**可能原因：**
```
1. 元素定位失败（Amazon改版）
2. ASIN不存在
3. 网络问题
4. 权限不足
```

**解决步骤：**
```
1. 打开控制台查看详细错误
2. 手动测试每一步是否能点击
3. 使用学习模式重新学习元素
4. 调整amazon-navigator.js的查找策略
```

### 问题5: 字段未填写

**诊断步骤：**

1. **检查元素是否存在**
```javascript
// 在控制台运行
document.querySelectorAll('input, textarea, select').length
// 应该返回数字 > 0
```

2. **检查UID是否正确**
```javascript
// 测试特定UID
document.querySelector('[uid="22_40"]')
// 应该返回元素或null
```

3. **运行页面分析**
- 使用插件的"页面分析"功能
- 查看所有可用字段
- 对比AMAZON_AUTOMATION_REQUIREMENTS.md文档

---

## 📈 性能测试（可选）

### 测试1: 单商品耗时

**操作：** 上传1个商品，计时完整流程

**预期：**
```
ASIN搜索: 10-15秒
填写4页: 20-30秒
总耗时: 30-45秒
```

### 测试2: 批量商品

**操作：** 上传10个商品，测试批量处理

**预期：**
```
每个商品: 40-50秒
10个商品: 7-10分钟
含延迟: 10-15分钟（推荐）
```

### 测试3: 内存占用

**操作：**
```
Chrome任务管理器 (Shift+Esc)
→ 查看插件内存使用
```

**正常范围：** < 100MB

---

## 🎯 测试报告模板

完成测试后，可以使用此模板记录结果：

```markdown
# 测试报告

测试日期: ___________
测试人: ___________
浏览器版本: Chrome ___________
插件版本: 2.0.0

## 测试结果

### 基础功能
- [ ] 通过 / [ ] 失败 - 插件加载
- [ ] 通过 / [ ] 失败 - 页面监控
- [ ] 通过 / [ ] 失败 - Excel上传

### 核心功能
- [ ] 通过 / [ ] 失败 - ASIN搜索
- [ ] 通过 / [ ] 失败 - 自动导航
- [ ] 通过 / [ ] 失败 - 表单填写

### 发现的问题

1. 问题描述: ___________
   重现步骤: ___________
   预期行为: ___________
   实际行为: ___________

2. ...

### 总体评价

[ ] ✅ 可以正式使用
[ ] ⚠️ 需要小修改
[ ] ❌ 需要大修改

### 备注

___________
```

---

## 🚀 测试通过后的下一步

如果所有测试都通过：

1. **准备真实数据**
   - 使用真实商品信息
   - 准备真实图片
   - 确保数据准确

2. **小规模试运行**
   - 先上传3-5个真实商品
   - 验证Amazon后台数据
   - 确认所有字段正确

3. **正式批量使用**
   - 准备完整商品列表
   - 合理安排上传时间
   - 持续监控日志

4. **性能优化**
   - 调整延迟时间
   - 优化元素查找
   - 改进错误处理

---

**祝测试顺利！** 🎉

如有问题，随时查看控制台日志或联系技术支持。
