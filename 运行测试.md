# 🚀 运行紫鸟浏览器连接测试

## ✅ 配置已完成

你的测试脚本已经配置好了：

- ✅ 紫鸟浏览器路径: `D:\ziniao\ziniao.exe`
- ✅ 公司名称: `banbantt`
- ✅ 用户名: `Abanbantt`
- ✅ 通信端口: `8848`

---

## 📝 运行前检查清单

### 1️⃣ 确认紫鸟浏览器未运行

**重要**: 必须关闭所有正在运行的紫鸟浏览器窗口！

检查方法：
- 按 `Ctrl + Shift + Esc` 打开任务管理器
- 查找 `ziniao.exe` 进程
- 如果存在，右键结束任务

### 2️⃣ 安装Python依赖

打开命令提示符（CMD），运行：

```bash
cd C:\Users\zhouk\Desktop\ziniao
pip install requests
```

### 3️⃣ 确认WebDriver权限

确保你的账号已经在紫鸟开放平台申请了 WebDriver 权限。

如果还没有申请：
- 访问: https://open.superbrowser.com/
- 登录你的账号
- 申请开通 WebDriver 权限
- 添加生态管家微信，备注"紫鸟webdriver"

---

## 🎯 开始测试

### 方法1: 命令行运行（推荐）

1. 打开命令提示符（CMD）
2. 进入项目目录：
   ```bash
   cd C:\Users\zhouk\Desktop\ziniao
   ```
3. 运行测试脚本：
   ```bash
   python test_ziniao_connection.py
   ```

### 方法2: 双击运行

直接双击 `test_ziniao_connection.py` 文件

**注意**: 如果窗口一闪而过，说明有错误，请使用方法1在命令行中查看详细信息。

---

## 📊 测试流程

脚本会依次执行以下测试：

```
步骤 1/5: 启动紫鸟浏览器
  ↓
步骤 2/5: 测试HTTP连接
  ↓
步骤 3/5: 登录紫鸟账号
  ↓
步骤 4/5: 获取店铺列表
  ↓
步骤 5/5: 启动店铺浏览器
  ↓
测试总结
```

整个过程大约需要 **1-2分钟**。

---

## ✅ 预期成功结果

如果测试成功，你会看到：

```
============================================================
     紫鸟浏览器连接测试脚本
============================================================

⚠️  测试前请确保:
  1. 紫鸟浏览器主进程已关闭
  2. 已配置正确的安装路径和账号信息
  3. 已申请开通WebDriver权限

按 Enter 键开始测试...

============================================================

步骤 1/5: 启动紫鸟浏览器

============================================================

ℹ️  操作系统: Windows
ℹ️  客户端路径: D:\ziniao\ziniao.exe
ℹ️  通信端口: 8848
✅ 紫鸟浏览器启动命令已执行

============================================================

步骤 2/5: 测试HTTP连接

============================================================

✅ HTTP连接成功！

============================================================

步骤 3/5: 登录紫鸟账号

============================================================

✅ 登录成功！

============================================================

步骤 4/5: 获取店铺列表

============================================================

✅ 获取到 X 个店铺

============================================================

步骤 5/5: 启动店铺浏览器

============================================================

✅ 店铺浏览器启动成功！
ℹ️  调试端口: 9222

============================================================

📊 测试总结

============================================================

✅ 基础连接测试通过
✅ 账号登录测试通过
✅ 成功获取 X 个店铺
✅ 店铺浏览器启动成功

✅ 恭喜！紫鸟浏览器连接测试全部通过！
接下来可以开始开发RPA自动化功能了。
```

---

## ❌ 可能遇到的错误

### 错误1: 找不到模块 'requests'

**错误信息:**
```
ModuleNotFoundError: No module named 'requests'
```

**解决方法:**
```bash
pip install requests
```

---

### 错误2: 无法连接到紫鸟浏览器

**错误信息:**
```
❌ 无法连接到紫鸟浏览器
```

**可能原因:**
1. 浏览器未成功启动
2. 端口被占用

**解决方法:**
1. 等待更长时间（浏览器启动可能需要10-15秒）
2. 检查任务管理器中是否有 `ziniao.exe` 进程
3. 尝试更换端口（在脚本中修改 `ZINIAO_PORT = 8849`）
4. 手动启动一次紫鸟浏览器，确认能正常打开

---

### 错误3: 登录失败

**错误信息:**
```
❌ 登录失败: 账号或密码错误
```

**解决方法:**
1. 确认公司名、用户名、密码是否完全正确（区分大小写）
2. 确认账号已开通 WebDriver 权限
3. 尝试用这些账号信息手动登录紫鸟客户端确认

---

### 错误4: 没有店铺

**提示信息:**
```
⚠️  账号下没有店铺
```

**解决方法:**
1. 手动打开紫鸟浏览器客户端
2. 创建至少一个店铺（任意平台）
3. 重新运行测试

---

### 错误5: 权限问题

**错误信息:**
```
❌ API错误: 权限不足
```

**解决方法:**
- 确认已在紫鸟开放平台申请 WebDriver 权限
- 联系紫鸟客服确认权限状态
- 微信添加生态管家，备注"紫鸟webdriver"

---

## 🎉 测试成功后

恭喜！技术方案验证通过，可以开始正式开发了！

### 下一步选择：

**选项A: 查看完整规划**
- 打开 `项目规划文档.md`
- 了解完整的开发计划和架构

**选项B: 查看代码实现**
- 打开 `技术实现方案.md`
- 查看详细的代码示例

**选项C: 开始开发**
- 告诉我开始创建完整的项目代码框架
- 我会帮你搭建整个项目结构

**选项D: 其他需求**
- 比如先设计Excel表格模板
- 或者先测试亚马逊页面分析

---

## 📞 需要帮助？

如果测试遇到问题：

1. 查看详细错误信息
2. 参考上面的"可能遇到的错误"章节
3. 查看 `测试说明.md` 获取更详细的排查指南
4. 联系我继续协助

---

## 💾 保存测试结果

测试成功后，建议：

1. 截图保存测试成功的结果
2. 记录调试端口号
3. 确认店铺数量和名称

这些信息在后续开发中会用到。

---

祝测试顺利！🚀

**准备好了吗？按照上面的步骤开始运行测试吧！**
